# Машинное обучение "без учителя". Задача кластеризации.
Работу выполнила: Бобина Татьяна Сергеевна ПМИ3-1

В практических примерах ниже показано:

* как пользоваться инструментами визуального анализа для предварительной интерпретации кластеров
* как проводить кластерный анализ
* как строить прогноз принадлежности к кластерам новых наблюдений
* как оценивать точность кластеризации
Модели: иерархический и неиерархический кластерный анализ

Данные: load_iris

Данные в примере:

* sepal length (cm) - длина чашелистика (см)
* sepal width (cm) - ширина чашелистика (см)
* petal length (cm) - длина лепестка (см)
* petal width (cm) - ширина лепестка (см)
#### Задача состоит в разделении ирисов на группы в зависимости от показателей(sepal length (cm), sepal width (cm))
![image](https://user-images.githubusercontent.com/114190495/224506133-d6278e99-3980-43a6-b0cc-d6a72a61c45a.png)

![image](https://user-images.githubusercontent.com/114190495/224506077-35b73d7b-d7f1-46a3-9607-fa5b841e8e09.png)

В нашем примере наблюдения визуально сгруппированы на 4 группы. Тем не менее, рассмотрим метод для определения наилучшего количества кластеров.

## Определение оптимального количества кластеров для метода локтя
![image](https://user-images.githubusercontent.com/114190495/224506204-6a57eb41-5708-4c29-b0bc-6bc324a874ad.png)

Как видно на следующем выше графике, локоть расположен в k = 4, что свидетельствует о том, что k = 4 является хорошим выбором для этого набора данных

![image](https://user-images.githubusercontent.com/114190495/224506224-b4176a2f-07c3-4830-ab7b-c71c389a0e9e.png)

Bизуальный анализ говорит о наличии 3 различных групп. Сделаем и такое построение:
![image](https://user-images.githubusercontent.com/114190495/224506325-4139ba9c-036d-47d4-8fdc-1ea08e36b73b.png)

Теперь видим, что каждая группа точек покрашена в цвет соответствующего кластера, а центроиды расположены внутри множества точек. Тем не менее, попробуем оценить качество кластеризации в обоих вариантах.

## Количественная оценка качества кластеризации
Задача оценки качества кластеризации является более сложной по сравнению с оценкой качества классификации. Во-первых, такие оценки не должны зависеть от самих значений меток, а только от самого разбиения выборки. Во-вторых, не всегда известны истинные метки объектов, поэтому также нужны оценки, позволяющие оценить качество кластеризации, используя только неразмеченную выборку.

Выделяют внешние и внутренние метрики качества. Внешние используют информацию об истинном разбиении на кластеры, в то время как внутренние метрики не используют никакой внешней информации и оценивают качество кластеризации, основываясь только на наборе данных. Оптимальное число кластеров обычно определяют с использованием внутренних метрик.
Средний коэффициент силуэта --  0.4450525692083638
![image](https://user-images.githubusercontent.com/114190495/224506374-00ec1f96-ad30-420f-8af8-42dd780e8832.png)

Средний коэффициент силуэта весьма близок к 0.5 , что говорит о относительным качестве кластеризации. Если силуэты зрительно значительно отличаются друг от друга по длине, то это является признаком субоптимальной кластеризации. Как правило, в этом случае центроиды кластеров стоят отдельно от множества точек кластера. Посчитаем средний силуэтный коэффициент для кластеризации k=4.

Средний коэффициент силуэта --  0.4248889536419922

Его значение немного ниже, чем в предыдущем случае. Формально k=3 - более оптимальное разбиение.


## Сравнение результатов на обучающей и тестовой выборке

Посмотрим, как прогнозировать новых наблюдений принадлежность к кластерам, построенным по обучающим данным. Сравним значения средних силуэтных коэффициентов.

В обучающей выборке - 80% исходных наблюдений.
Добавляем к выборке дополнительный показатель.
![image](https://user-images.githubusercontent.com/114190495/224506455-2b214054-edfb-4712-b935-f10529b0b2d5.png)

![image](https://user-images.githubusercontent.com/114190495/224506488-8f5c16c2-722a-4a4e-88a9-409e7db571fe.png)

Как видно на следующем выше графике, заметных изменений не обнаружилось.

Обучаем алгоритм и считаем средний силуэтный коэффициент.

Средний коэффициент силуэта --  0.5426144380745519

Средний коэффициент силуэта --  0.5862478392183824

Применяем модель к новым данным. Значение среднего силуэтного коэффициента незначительно ухудшилось.

### Статистический анализ получившихся кластеров

![image](https://user-images.githubusercontent.com/114190495/224506592-4a2ac8a6-3080-4181-ad29-a33c94799ab5.png)
![image](https://user-images.githubusercontent.com/114190495/224506608-acacdf09-3742-4a78-8b6b-693a250545ca.png)

Визуально кластеры немного отличаются друг от друга. Судя по графикам плотности, по показателю petal_length имеют различия, а по sepal_length и sepal_width имеют некоторые сходства. По диаграммам разброса видно, что оба кластера образуют не совсем плотное множество точек, разбиение нестрогое.

Accuracy: 0.23333333333333334

Из оценки кластеризации следует, что алгоритм (при разбиении на 3 кластера) достиг не высокой точности в своей работе

Accuracy: 0.88

Из оценки кластеризации следует, что алгоритм (при разбиении на 3 кластера) достиг высокой точности в своей работе, указывая правильную категоризацию большинства объектов данных.
